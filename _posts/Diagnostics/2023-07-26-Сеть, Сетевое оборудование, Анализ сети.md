---
layout: post
title:  Сеть, Сетевое оборудование, Анализ сети
category: Diagnostics
---

#сеть

## Сеть, Сетевое оборудование, Анализ сети


- lspci \| grep Ethernet 	--            Информация о контроллере Ethernet

- lspci \| grep -i 'net' 	  --           Просмотр доступных сетевых карт

- lspci \| egrep -i --color 'network\|ethernet'  --	Узнать модель сетевой карты

- lspci -v \| grep Ethernet -A 1 --	Узнать модель сетевой карты, более детальный вывод

- lspci -v \| grep Ethernet -A 20  --	Еще более подробная информация о сетевом оборудовании в системе

- lspci -kv \| less   -- Более подробная информация о сетевом оборудовании в системе
	
- lshw -class network  --	Более подробная информация о сетевом оборудовании в системе через утилиту lshw

- dmesg \| grep eth  --	Проверка обнаружения сетевого оборудования

- ethtool eth0  --	Для отображения настроек сетевой карты в ethtool запустите утилиту передав в параметрах имя сетевого адаптера

- ethtool -i eth0  --	Для просмотра информации о сетевом драйвере и прошивке

- ethtool -P eth0  --	Узнать MAC адрес

- ethtool eth0 \| grep "Speed\|Duplex"  --	Узнать текущую скорость передачи данных сетевой карты

- ethtool -s eth0 duplex full speed 100 autoneg off --	Для принудительного понижения скорости до 100 Мбит/с в режиме Full Duplex и отключения автоопределения настроек

- ethtool -s eth0 duplex full speed 1000 autoneg off  --	Вернуть сетевую карту в гигабитный режим

- mii-tool -F 100baseTx-FD eth0  --	Понизить скорость до 100 Мбит/с в режиме Full Duplex, не имея ethtool

- ifconfig eth0 media 100baseTX mediaopt full-duplex --	Понизить скорость до 100 Мбит/с в режиме Full Duplex, вариант совсем для гиков

- ifconfig  --	Просмотр сетевых интерфейсов, количество переданных/принятых пакетов, IP адрес, маска и т. д.

- ifconfig \| grep 'inet addr:' -- 	Узнать все ip адреса сервера, в том числе и ipv6. При ошибке доустановить пакет net-tools

- ifconfig \| grep 'inet addr:' \| cut -d: -f2 \| awk '{ print $1}' --	Показать только ip адреса, без лишней информации

- ifconfig \| awk '/inet addr:/ {print substr($2, 6)}' --	Показать только ip адреса, без лишней информации

- ifconfig \| awk '/inet addr:/ {print substr($2, 6)}' \| grep -v 127.0.0.1 --	Позволяет убрать локальный интерфейс, чтобы глаза не мозолил

- ip link show  --	Подробная информация о сетевом протоколе для сетевой карты

- ip a  --	Посмотреть сетевые интерфейсы

- ip a \| grep inet \| awk '{print $2}' --	Показать только ip адреса, без лишней информации

- ifconfig \| grep 'inet addr:'  --	Вовод информации - inet addr, Bcast, Mask

- ping -n -i 0.2 -s 512 -I eth0 ya.ru --	Проверить передачу пакетов по сети

- traceroute -N 16 -q 1 -A ya.ru --	Проверить передачу пакетов по сети

- mtr ya.ru  --	Проверить передачу пакетов по сети

- ip route get 10.94.171.10  --	Узнать, через какую запись в таблице маршрутизации пойдет трафик на IP адрес

- iptraf -d eth0  --	Посмотреть суммарную статистику по интерфейсу. Узнать что забивает канал

- iptraf -i eth0 --	Просмотр статистики по соединениям

- nload --	Утилита анализа трафика
```
Опции nload:

device - выбор интерфейса

-a - промежуток в секундах, для подсчитывания среднего значения

-i - стопроцентная планка на графике пропускной способности в kBit/s

-m - отображение нескольких интерфейсов, без графика

-t - интервал обновления в миллисекундах

-u - режим отображения: Bit/s, kBit/s, MBit/s
```

- iwlist scan 2> /dev/null \| grep ESSID \| wc -l  --	Узнаем сколько есть точек доступа Wi-Fi

- route -n 
```	
Узнать адрес шлюза по умолчанию, на который будут отправляться все пакеты,

для которых не прописаны дополнительные правила в таблице маршрутизации.

Из вывода команды нас интересует строка с подсетью 0.0.0.0 и аналогичной маской, это и есть адрес шлюза по умолчанию.
0.0.0.0 192.168.3.1 0.0.0.0 UG 0 0 0 eth0
Искомый адрес 192.168.3.1, в малых сетях это как правило адрес роутера или сервера выполняющего роль шлюза в интернет.
```

- netstat -tlnp --	Узнать кто подключился к вашему ПК

- ssh-copy-id username@remote-machine  --	Подключение по SSH без пароля

- ngrep google port 80 --	Показать содержимое всех пакетов, прошедших по 80 порту, со словом google

- ngrep -i \'game*\|chat\|recipe\' -W byline -d eth0  --	Вывод пакетов удовлетворяющих маске по одному в строке, для интерфейса eth0

- ngrep -i \'rcpt to\|mail from\' -d any tcp port smtp  --	Слушать весь SMTP трафик на всех сетевых интерфейсах

- ngrep -q -t -wi "login" port 23  --	Показать текущее время для каждого совпадения (кто и когда заходит на машину телнетом)

- echo -e {$HTTP,\\\n$FTP,\\\n$HTTPS}_PROXY  --	Проверить прокси в /etc/sysconfig/network, настраивается локально через alterator-sysconfig/proxy

- ip route   --    Информация о сетевом соединении

***И в этом случае ищите строку вида:***

- default via 10.1.1.254 dev enp2s0  proto static  metric 100

В случае, если вас интересует внешний IP-адрес в сети интернет, который будет отображаться у всех рабочих станций вашей локальной сети скрытых NAT, то вы можете воспользоваться web-сервисом: 

[https://2ip.ru](https://2ip.ru/) 

или другим подобным.

