---
layout: post
title:  SSD + HD
category: Diagnostics
---

#ssd #hdd

## SSD + HDD

- systemctl status fstrim.timer  --	Проверить включен ли TRIM

- lsblk  --	Посмотреть подключённые жёсткие диски

- lsblk -o NAME,SIZE,UUID,TYPE,MOUNTPOINT  --	Посмотреть информацию о дисках

- cat /proc/partitions -- 	Посмотреть информацию о дисках

- inxi -plo  --	Информация о разбиении диска. разделы диска

- inxi -h --	Посмотреть флаги разделов жесткого диска

- mount  --	Посмотреть информацию о подключенных устройствах и параметрах подключения

- df -H  --	Посмотреть список партиций, их точки монтирования, использование места, тип файловой системы

- df -h  --	Узнать размер свободного пространства на разделах диска

- du -hs * 2>/dev/null \| sort -h  --	Отсортировать файлы по размеру

- fdisk -l  --	Все партиции, названия устройств и геометрия hdd

- hdparm -iv /dev/sda --	Посмотреть идентификационную информацию, собранной во время загрузки ОС

- hdparm -Tv /dev/sda  --	Измерить время чтения из кэша, для верности показателей - повторить 2-3 раза на неактивном диске

- hdparm -Tt /dev/sda --	Сравнение времени чтения устройства. Полная статистика. Для получения значимых результатов эту операцию следует повторить 2-3 раза в неактивной системе

- hddtemp -uC /dev/sda --	Отображение температуры в Цельсиях для винчестера /dev/sda (установочный пакет hddtemp)

- hdparm -I /dev/sda  --	Информация о диске (модель, прошивка, атрибуты и пр)

- smartctl -d ata -a -i /dev/sda  --	Информация о диске (модель, прошивка, атрибуты и пр)

- smartctl -a /dev/sda  --	Вывод SMART информация для винчестера /dev/sda (необходим пакет smartmontools)

- baobab  --	Графическая утилита для анализа места на жестком диске в GNOME

- ncdu /  --	Консольная утилита для анализа места на жестком диске

- ls -lh /var/log/  --	Посмотреть содержимое папки с выводом в мегабайтах, килобайтах и пр. 

- parted /dev/sdX print  --	Информация о жестком диске - sdX, X заменить на букву диска - a,b,c

- gdisk -l /dev/sda --	Покажет раздел загрузчика с кодом раздела EF00

- tree -L 3 /boot --	Вывод структуры ввиде дерева

- df -h \| awk '$NF=="/"{printf "Disk Usage: %d/%dGB (%s)\n", $3,$2,$5}' --	Расчет использования жесткого диска

- e2fsck -cfpv /dev/sda1 --	для восстановления битых секторов жесткого диска и подождать несколько часов

- whdd --	Консольная Ncurses утилита для диагностики жёстких дисков и восстановления данных с них

## Диагностика жесткого диска и восстановление данных

- find -type f -printf "%k\t%p\n" \| sort -n \| tail --	Найти десять самых больших файлов. Размер в блоках по килобайту

- ls -1 /dev/sd?  --	Получить список устройств

- fdisk -l /dev/sda  --	Посмотреть какие разделы есть на диске "sda"

## Узнать, что переполняет диск

- du <путь>  --	sort -n. В альте можно отключить резервное копирование (bacula-fd) и почистить /var

- gparted --	Графическая утилита для работы с дисками и разделами

- filelight  --	Графическое представление использования дисков/
флешек

- baobab  --	Графическое представление использования дисков/флешек в Gnome

- ncdu  --	Консольный анализатор использования дисков/флешек

*Жёсткие диски имеют особенные названия. 
В зависимости от интерфейса, через который подключён жёсткий диск, название может начинаться на:*

- sd — устройство, подключённое по SCSI;

- hd — устройство ATA;

- vd — виртуальное устройство;

- mmcblk — обозначаются флешки, подключённые через картридер;

В наше время большинство блочных устройств Linux подключаются через интерфейс SCSI. Сюда входят жёсткие диски, USB-флешки, даже ATA-диски теперь тоже подключаются к SCSI через специальный переходник.

Поэтому в большинстве случаев вы будете иметь дело именно с дисками sd. Третья буква в имени диска означает его порядковый номер в системе. Используется алфавитная система.

Например: 

- sda — первый диск, 

- sdb — второй диск, 

- sdc — третий и так далее. 

Дальше следует цифра — это номер раздела на диске:

- sda1,
 
- sda2.

