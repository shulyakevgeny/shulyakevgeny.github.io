---
layout: post
title: BTRFS на ALT
category: Linux
---

#btrfs

# BTRFS на ALT 

Подтом (subvolume) не является блочным устройством, но в каждом томе btrfs создаётся один подтом верхнего уровня (subvolid=5), в этом подтоме могут создаваться другие подтома и снапшоты. Подтома (подразделы, subvolumes) создаются ниже вершины дерева btrfs по мере необходимости, например, для / и /home создаются подтома с именами @ и @home. Это означает, что для монтирования подтомов необходимы определенные параметры вместо корня системы btrfs по умолчанию:

подтом @ монтируется в / с помощью опции subvol=@
подтом @home (если он используется) монтируется с помощью параметра монтирования subvol=@home

Т.к. для Timeshift система должна быть установлена на раздел BTRFS с разбивкой на подразделы @ и @home, то в данной статье рассмотрен именно этот вариант.

В данной статье использовались дистрибутивы на основе десятой платформы.

Установка ALT на btrfs

В некоторых дистрибутивах ALT (Рабочая станция, Рабочая станция К, Сервер Виртуализации) btrfs доступен в инсталляторе.

Создание подтомов в инсталляторе

В дистрибутиве Рабочая станция К, начиная с версии 10.1 (текущий статус: beta2) можно создать подтома (@ и @home) в инсталляторе.

В этом случае после установки системы не потребуется никаких действий по созданию подтомов.

## Автоматический профиль разбиения диска

Если выбрать автоматический профиль разбиения диска «Установка рабочей станции (совместима с Timeshift)»:

![](/image/ALT/1.Install-system-prepare-hdd.png)

то при разбиении диска будут выделены отдельные разделы для подкачки и для корневой файловой системы (файловая система BtrFS). При этом будут созданы:

подтом @ с точкой монтирования в /;
подтом @home с точкой монтирования в /home.

![](/image/ALT/2.Install-system-btrfs-auto.png)

## Ручной профиль

Создание подтомов @ и @home при выборе профиля разбиения диска «Вручную»:

Создать раздел для корневой файловой системы. При указании файловой системы, выбрать BtrFS:

![](/image/ALT/3.Install-system-btrfs-01.png)

Не указывать точку монтирования, для этого в следующем окне нажать кнопку «Отменить»:

![](/image/ALT/4.Install-system-btrfs-02.png)

Создать два подтома (@ и @home):
Нажать кнопку «Создать подтом»

![](/image/ALT/5.Install-system-btrfs-03.png)

Указать имя подтома (@, @home) или путь до него (/@, /@home):

![](/image/ALT/6.Install-system-btrfs-04.png)

Указать точки монтирования для каждого подтома:
Нажать кнопку «Изменить точку монтирования»:

![](/image/ALT/7.Install-system-btrfs-05.png)

Указать точку монтирования:

![](/image/ALT/8.Install-system-btrfs-06.png)

Результат:

![](/image/ALT/9.Install-system-btrfs-auto.png)


## Создание снимков

**Снимки/snapshots** удобно делать и использовать в программе с графическим интерфейсом **Timeshift**.
