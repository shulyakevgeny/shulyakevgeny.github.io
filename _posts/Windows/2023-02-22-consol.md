---
layout: post
title:   Консольные команды Windows
category: Windows
---

В самых первых версиях **Windows** многие задачи можно было выполнить только через консольные команды. Сейчас «скелет» взаимодействия между человеком и машиной скрыт под удобным графическим интерфейсом. Однако пользователю подчас удобнее всего обратиться к консоли. В этом материале мы расскажем о самых полезных консольных командах **Windows**.

### Немного про консоль

Командная строка в операционных системах **Microsoft** впервые появилась еще в **MS-DOS**, более 40 лет назад. В **Windows** количество команд расширилось, некоторые команды изменили. Развитие командной системы остановилось лишь с выпуском **Windows 2000**. К тому времени графический интерфейс окончательно победил консольный.

Несмотря на это, все последующие версии **Windows** имеют в своем составе командную строку. И, само собой, они поддерживают старые команды для обратной совместимости. Это справедливо и для современных **Windows 10 и 11**. Всего насчитывается более **300** команд. В современных **ОС** реальное применение всем им найти непросто. Многие действия проще выполнить несколькими кликами мышки. Но среди этого множества команд существует множество весьма полезных. 

Командная строка находится в списке программ в меню **«Пуск»**: в папке **«Служебные»** для **Windows 10/11**, в папке **«Стандартные»** для систем **Windows 7 и старше**. Многие команды требуют наличия прав администратора. Для их работы нужно запускать командную строку щелчком правой кнопки мыши по ярлыку, затем выбрав **«Запуск от имени администратора»**. Для описания доступных взаимодействий можно вызвать справку по любой команде. Достаточно после нее добавить атрибут **/?**

Есть и альтернатива в виде **PowerShell** — он «понимает» команды для командной строки. Его тоже можно найти в списке программ меню **«Пуск»**. В современных **Windows 10 и 11** начать работу с ним еще легче — нужно лишь щелкнуть правой кнопкой по кнопке **«Пуск»** и выбрать соответствующий пункт.

### Диагностика

**Systeminfo** — команда, позволяющая получить подробную информацию о программной и аппаратной конфигурации компьютера. Там можно найти много полезных для пользователя данных.

●   информация о «железе»;
●   версия сборки системы;
●   список установленных обновлений;
●   дата установки и последней загрузки ОС.

### Восстановление поврежденных данных

**Recover** — консольная утилита для восстановления данных с поврежденных носителей. Как это работает? Сначала надо указать путь к восстанавливаемому диску или папке, прописав его в команде. Например: **recover D:\\**

После этого выполняется посекторное считывание файлов с диска. Сохранившиеся данные извлекаются. Однако битые секторы игнорируются. Поэтому для работы с накопителями, у которых много сбойных секторов, инструмент не очень подходит. 
Команда работает только с накопителями, отформатированными в файловой системе **NTFS. FAT и FAT32** не поддерживаются.

**Sfc** — утилита **System File Checker**. Используется для проверки целостности компонентов **Windows**. При введении команды без дополнительных атрибутов открывается справка. В ней подробно описано, как работать с утилитой.
Команда позволяет проверить системные файлы на целостность. При повреждении их можно восстановить — как по одному, так и все вместе.
Самым популярным и используемым атрибутом, несомненно, является **scannow**. Команда **sfc /scannow** автоматически проверяет все системные файлы и самостоятельно восстанавливает поврежденные фрагменты.

Wbadmin — инструмент архивации данных. С его помощью можно осуществить резервное копирование или восстановление дисков, папок и файлов. Команда начала резервного копирования выглядит как wbadmin start backup с дополнительными атрибутами. Восстановление осуществляется командой wbadmin start recovery, также имеющей собственные атрибуты для указания источника и пути восстановления.

### Работа с дисками

**Certutil** -  программа, работающая из командной строки. Отвечает за управление службами сертификации. Что она может делать?

●   кодирование и декодирование файлов с помощью ключей **/encode** и **/decode**;
●   вычисление контрольных сумм через ключ **/hashfile**;
●   расшифровка кодов ошибок Windows с помощью комманды **/error**.

Полный список ключей очень обширен. Как и у других команд, может быть вызван с помощью ключа **/?**

**Chkdsk** — команда, которая проводит диагностику файловой системы и устраняет обнаруженные ошибки. Работает с файловыми системами **FAT, FAT32 и NTFS**. Для указания пути и опций сканирования следует использовать дополнительные атрибуты.

**Cipher** — команда для шифрования файлов на уровне файловой системы **NTFS**. В домашнем использовании может понадобиться ключ **/w**. Данная команда затирает свободное место во всем томе. Это предотвращает возможное восстановление удаленных данных специализированными программами. Если накопитель пуст, «обнуляется» весь его объем.

**Defrag** — инструмент дефрагментации для жестких дисков. Информация на этих магнитных накопителях часто записывается хаотично. Применение дефрагментации позволит объединить несколько частей файлов. Это повышает скорость чтения и уменьшает ее задержку. В консоли пользователь может указать диск и параметры работы с ним. 
Перед началом дефрагментации предлагается оценить ее необходимость. Сделать это можно с помощью указания диска и атрибута анализа **/a**. Например: **defrag D: /a**

**Diskpart** — утилита для управления разделами накопителей. Позволяет создавать, удалять и преобразовывать тома на дисках, изменять их атрибуты и помечать активными. Отличительная особенность работы с **Diskpart** — необходимость вводить команды последовательно.
Работа начинается с команды **list disk** или **list volume**. Они перечисляют в окне командной строки список физических дисков и дисковых томов. В отличие от других утилит, которые требуют указать букву диска, здесь выбор диска или тома осуществляется с помощью ввода его порядкового номера. После этого вводится команда нужного действия.

**Fsutil** — служебная утилита управления объектами файловой системы. Помимо управления файлами, позволяет отсоединять, изменять размер и просматривать информацию о логических томах. Рекомендуется для опытных пользователей. Для ее использования надо точно знать, какие команды следует применять для достижения конкретной цели.

### Диспетчер задач и службы

**Tasklist** — команда для просмотра выполняющихся в операционной системе процессов. Дублирует вкладку «Процессы» диспетчера задач. Может пригодиться при его недоступности или неработоспособности — например, при заражении системы вирусами.

**Taskkill** — инструмент для завершения процессов. Вместе с командой tasklist позволяет находить и завершать необходимые процессы без использования диспетчера задач. С этой командой можно закрыть ненужные программы при сбоях графического интерфейса и диспетчера задач. Для завершения определенного процесса необходимо указать дополнительные атрибуты.

**Shutdown** — инструмент для выключения или перезагрузки компьютера. В отличие от соответствующих кнопок в меню **«Пуск»**, поддерживается расширенная функциональность. Доступны отложенные действия по таймеру, немедленное отключение с принудительным закрытием запущенных программ. Ключ **/s** отвечает за выключение компьютера, ключ **/r** - за перезагрузку. Чтобы активировать действие команд по таймеру, применяется ключ /t с желаемым временем в секундах. Например, запланированная через минуту перезагрузка будет выглядеть так: **shutdown /r /t 60**. Есть у инструмента и графический интерфейс, который можно вызвать командой **shutdown /i**.

### Сетевые утилиты

**Ping** — утилита для проверки соединения с определенным сервером или узлом в сети. Она посылает запросы по указанному адресу и фиксирует время ответов, задержек и потерь пакетов. С помощью этих данных можно оценить стабильность работы с сетью или конкретным сайтом. Команда поддерживает как IP, так и интернет-адреса. В последнем случае IP-адрес ресурса высветится автоматически после начала работы. По умолчанию производится всего четыре обмена данными с сервером. Если нужен постоянный опрос до отмены процедуры пользователем, после адреса нужно использовать команду **—t**.

**Tracert** — команда для трассировки маршрута до определенного интернет-узла. Утилита отправляет запросы на указанный адрес, как и команда ping. При этом отображается информация о всех промежуточных маршрутах, через которые запросы проходят по пути к нужному ресурсу. Также фиксируется время каждой доли маршрута в миллисекундах. Это позволяет оценить полный путь траффика и участок, на котором возникают наибольшие задержки.

**Pathping** — команда объединяет возможности команд ping и tracert. Она позволяет оценить задержки передачи данных и потери пакетов на каждом участке маршрута к определенному узлу.

**Netsh** — утилита для конфигурирования сетевых параметров. Обладает немалым количеством дополнительных команд. Некоторые из них действительно полезны для обычного пользователя.

●   **interface ip show config** показывает подробную информацию о текущих настройках TCP/IP;
●   **interface dump > mycfg.dat** сохраняет текущую конфигурацию **TCP/IP**;
●   **netsh exec mycfg.dat** восстанавливает конфигурацию **TCP/IP** из ранее сохраненной.

**Net** — мощная утилита контроля над сетевыми ресурсами. Функциональность и количество комбинаций поддерживаемых команд огромно. Net часто используется в задачах системного администрирования. Неопытному пользователю без четких представлений о действиях команд утилитой лучше не пользоваться.

**Arp** — инструмент для показа или изменений записей кэша протокола ARP, содержащего таблицы соответствия физических MAC-адресов и IP-адресов. Чтобы просмотреть эти данные, нужно использовать команду -a или -g.

**Ipconfig** — средство просмотра сведений о конфигурации используемых сетевых адаптеров (IP и MAC-адреса). Также обладает функцией очистки DNS-кеша. Она пригодится при неправильной работе службы доменных имен, сбоях при доступе к сайтам. Последняя осуществляется командой /flushdns.

**Netstat** — выводит сведения об активных сетевых соединениях. Позволяет просмотреть таблицы маршрутизации. С ее помощью можно определить, какие процессы используют сетевые подключения на определенных портах.

### Команды «Выполнить»

Помимо консольных команд, в **Windows** есть множество полезных утилит, запрятанных глубоко в недра системы. Для их запуска целесообразно использовать команду «Выполнить», которая, как и командная строка, находится в списке программ в меню **«Пуск»**. Впрочем, намного легче вызвать ее комбинацией клавиш **Win + R**. 

**Msinfo32** предоставляет полный список аппаратного обеспечения компьютера, ресурсов, компонентов, программного обеспечения и драйверов. Информация разделена по группам для удобной навигации.

**Mdsched** — встроенное средство диагностики оперативной памяти. После запуска программа предлагает сразу перезагрузить компьютер для начала диагностики — или же запланировать ее после следующей перезагрузки. В процессе выполнения с помощью клавиши F1 можно выбрать набор тестов и число проходов. 
В результате проверки программа выдаст результат «Неполадки пока не обнаружены», либо «Были обнаружены проблемы оборудования». Для более подробного описания результатов тестов после перезагрузки следует воспользоваться командой eventvwr. Данные проверки доступны по следующему пути: «**Журналы Windows — Система**» под именем «**MemoryDiagnostic-Results**».

**Verifier** — диспетчер проверки драйверов. Позволяет проверить системные драйверы, выявить проблемы и создать дамп памяти для дальнейшего анализа. Программа тестирует драйверы, создавая для них разные экстремальные условия — нехватку памяти, взаимные блокировки, контроль I/O, IRQL, проверки DMA. Целью проверок является имитация ситуаций, при которых драйвер может стать причиной «синего экрана» **BSOD**.

**Msconfig** позволяет изменять настройки запуска операционной системы, использовать для него дополнительные параметры (вроде безопасного режима), включать/отключать элементы автозагрузки и установленные службы.

**Mrt** — утилита для поиска в системе вредоносных программ. Обновляется через Windows Update, может использоваться в качестве начальных мер по очистке системы от зловредов. Однако Mrt — не полноценный антивирус, и заменить его, конечно, не сможет.